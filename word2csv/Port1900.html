<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" />
	<title>Port de Nantes en 1900</title>
</head>
<body>
	<div id="map" style="width: 1800px; height: 900px"></div>
	<script src="http://cdn.leafletjs.com/leaflet-0.5/leaflet.js"></script>
 	<script src="jquery.js"></script>
	<script>
		// create a map in the "map" div, set the view to a given place and zoom
		var map = L.map('map').setView([47.205, -1.575], 15);

		// add an OpenStreetMap tile layer
		L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
		    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
		}).addTo(map);

		//get json content
		markerarray=[];
		$.getJSON("coord.json", function(json) { // this will show the info it in firebug console
			for (var row in json) {
				// add a marker in the given location, attach some popup content to it and open the popup
				marker = L.marker([json[row].Latitude, json[row].Longitude]).addTo(map).bindPopup(json[row].Titre+"<br>"+json[row].Resume);
				markerarray.push(marker);
			}
		});

		//get json content from modified historical sheets
		$.getJSON("coord_new.json", function(json_new) { // this will show the info it in firebug console
			for (var row in json_new) {
				// verify the marker doesn't already exists
				var i;
				var test = false;
				for (i = 0; i < markerarray.length; i++) {
					if (markerarray[i].getLatLng().lat == json_new[row].Latitude && markerarray[i].getLatLng().lng == json_new[row].Longitude) {
						test = true;
						break;
					}
				}
				if (test == false) {
				L.marker([json_new[row].Latitude, json_new[row].Longitude]).addTo(map).bindPopup(json_new[row].Titre);
				}
			}
		});

	</script>
</body>
</html>
